#!/bin/bash

# display a big emoji

# 0.1" character pitch horizontally
# 0.16" vertically
# default to small
width=32
height=20
if [[ "$1" == "-big" ]]; then
    # large
    width=72
    height=45
    shift
fi

tmps=$(mktemp -t XXXXXX.svg)
tmpj=$(mktemp -t XXXXXX.jpg)
function cleanup() {
    rm $tmps
    rm $tmpj
}
trap cleanup EXIT

# ASR33 typewheel characters approximately sorted by print density
chars=" .-\';,<:>!/=^\"1_\\7?I)(+J[]TLCF3YS59*V#Z6PD$OAUH4EG0X&Q@%82KRBNWM"

url=$(emojiurl "$1")
if [[ $? == 0 ]]; then
    # fetch the SVG and convert to a JPG
    wget -q -O "$tmps" "$url"
    convert -density 300 -background white "$tmps" -background none -colorspace Gray -auto-level "$tmpj"

    # convert to ascii
    jp2a --invert --chars="$chars" --width=$width --height=$height "$tmpj"
fi
